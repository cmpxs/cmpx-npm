{"version":3,"file":"cmpx.umd.js","sources":["../../src/cmpxLib.ts","../../src/cmpxEvent.ts","../../src/htmlDef.ts","../../src/compile.ts","../../src/componet.ts","../../src/platform.ts","../../src/browser.ts"],"sourcesContent":["\r\nlet stringEmpty = \"\",\r\n    toString = Object.prototype.toString,\r\n    core_hasOwn = Object.prototype.hasOwnProperty,\r\n    noop = function () { },\r\n    slice = Array.prototype.slice;\r\n\r\nfunction testObject(obj: any) {\r\n    if (obj.constructor &&\r\n        !core_hasOwn.call(obj, \"constructor\") &&\r\n        !core_hasOwn.call(obj.constructor.prototype, \"isPrototypeOf\")) {\r\n        return false;\r\n    }\r\n}\r\n\r\nexport default class CmpxLib {\r\n    static stringEmpty = stringEmpty;\r\n\r\n    static noop = noop;\r\n\r\n    static hasOwnProp(obj: any, prop: string) {\r\n        return core_hasOwn.call(obj, prop);\r\n    }\r\n\r\n    static trace(e: any) {\r\n        console.error && console.error(e.stack || e.message || e + '');\r\n    }\r\n\r\n    static isType(typename: string, value: any) {\r\n        //typename:String, Array, Boolean, Object, RegExp, Date, Function,Number //兼容\r\n        //typename:Null, Undefined,Arguments    //IE不兼容\r\n        return toString.apply(value) === '[object ' + typename + ']';\r\n    }\r\n\r\n    static toStr(p: any): string {\r\n        return CmpxLib.isNull(p) ? '' : p.toString();\r\n    }\r\n\r\n    static isUndefined(obj: any) {\r\n        ///<summary>是否定义</summary>\r\n\r\n        return (typeof (obj) === \"undefined\" || obj === undefined);\r\n    }\r\n\r\n    static isNull(obj: any) {\r\n        ///<summary>是否Null</summary>\r\n\r\n        return (obj === null || CmpxLib.isUndefined(obj));\r\n    }\r\n\r\n    static isBoolean(obj: any) {\r\n        return CmpxLib.isType(\"Boolean\", obj);\r\n    }\r\n\r\n    static isNullEmpty(s: any) {\r\n        return (CmpxLib.isNull(s) || s === stringEmpty);\r\n    }\r\n\r\n    static isFunction(fun: any) {\r\n        return CmpxLib.isType(\"Function\", fun);\r\n    }\r\n\r\n    static isNumeric(n: any) {\r\n        //return cmpx.isType(\"Number\", n) && !isNaN(n) && isFinite(n);;\r\n        return !isNaN(parseFloat(n)) && isFinite(n);\r\n    }\r\n\r\n    static isString(obj: any) {\r\n        return CmpxLib.isType(\"String\", obj);\r\n    }\r\n\r\n    static isObject(obj: any) {\r\n        return obj && CmpxLib.isType(\"Object\", obj)\r\n            && !CmpxLib.isElement(obj) && !CmpxLib.isWindow(obj);//IE8以下isElement, isWindow认为Object\r\n    }\r\n\r\n    static tryCatch(tryFn: Function, catchFn: (e: any) => any, args: Array<any> = [], thisArg: any = null): any {\r\n        try {\r\n            return tryFn.apply(thisArg, args);\r\n        } catch (e) {\r\n            return catchFn.call(thisArg, e);\r\n        }\r\n    }\r\n\r\n    static isPlainObject(obj: any) {\r\n        if (!CmpxLib.isObject(obj)) return false;\r\n\r\n        try {\r\n            if (testObject(obj) === false) return false;\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n\r\n        var key;\r\n        for (key in obj) { }\r\n\r\n        return key === undefined || core_hasOwn.call(obj, key);\r\n    }\r\n\r\n    static encodeHtml(html: string): string {\r\n        return !html ? '' : html.replace(/\\&/g, '&amp;').replace(/\\</g, '&lt;').replace(/\\>/g, '&gt;')\r\n            .replace(/\\\"/g, '&quot;').replace(/ /g, \"&nbsp;\").replace(/\\'/g, \"&#39;\");\r\n    }\r\n\r\n    static decodeHtml(html: string): string {\r\n        return !html ? '' : html.replace(/&lt;/g, '<').replace(/&gt;/g, '>')\r\n            .replace(/&quot;/g, '\"').replace(/&nbsp;/g, ' ').replace(/&#39;/g, \"'\").replace(/&amp;/g, '&');\r\n    }\r\n\r\n    static isArray(value: any) {\r\n        return Array.isArray ? Array.isArray(value) : CmpxLib.isType(\"Array\", value);\r\n    }\r\n\r\n    static isWindow(obj: any) { return !!(obj && obj == obj.window); }\r\n\r\n    static isElement(obj: any) { var t = obj && (obj.ownerDocument || obj).documentElement; return t ? true : false; }\r\n\r\n    static trim(str: string, newline?: boolean) {\r\n        return str ? (newline ? str.replace(/^(?:\\s|\\u3000|\\ue4c6|\\n|\\r)*|(?:\\s|\\u3000|\\ue4c6|\\n|\\r)*$/g, '') :\r\n            str.replace(/^(?:\\s|\\u3000|\\ue4c6)*|(?:\\s|\\u3000|\\ue4c6)*$/g, '')) : '';\r\n    }\r\n\r\n    static replaceAll(s: string, str: string, repl: string, flags: string = \"g\") {\r\n        if (CmpxLib.isNullEmpty(s) || CmpxLib.isNullEmpty(str)) return s;\r\n        str = str.replace(/([^A-Za-z0-9 ])/g, \"\\\\$1\");\r\n        s = s.replace(new RegExp(str, flags), repl);\r\n        return s;\r\n    }\r\n\r\n    static inArray(list: Array<any>, p: any, thisArg: any = null): number {\r\n        var isF = CmpxLib.isFunction(p),\r\n            index = -1;\r\n        CmpxLib.each(list, (item, idx) => {\r\n            var ok = isF ? p.call(thisArg, item, idx) : (item == p);\r\n            if (ok) {\r\n                index = idx;\r\n                return false;\r\n            }\r\n        }, thisArg);\r\n        return index;\r\n    }\r\n\r\n    static toArray(p: any, start: number = 0, count: number = Number.MAX_VALUE): Array<any> {\r\n        return p ? slice.apply(p, [start, count]) : p;\r\n    }\r\n\r\n    static arrayToObject<T>(array: Array<T>, fieldName: string): { [name: string]: T } {\r\n        var obj: { [name: string]: T } = {};\r\n        CmpxLib.each(array, function (item: any, index: number) {\r\n            obj[item[fieldName]] = item;\r\n        });\r\n        return obj;\r\n    }\r\n\r\n    static each(list: any, fn: (item: any, idx: number) => any, thisArg: any = null) {\r\n        if (!list) return;\r\n        var len = list.length;\r\n        for (let i = 0, len = list.length; i < len; i++) {\r\n            if (fn.call(thisArg, list[i], i) === false) break;\r\n        }\r\n    }\r\n\r\n    static eachProp(obj: any, callback: (item: any, name: string) => void, thisArg: any = null) {\r\n        if (!obj) return;\r\n        var item;\r\n        for (var n in obj) {\r\n            if (CmpxLib.hasOwnProp(obj, n)) {\r\n                item = obj[n];\r\n                if (callback.call(thisArg, item, n) === false) break;\r\n            }\r\n        }\r\n    }\r\n\r\n    static extend(obj: Object, p: Object): Object {\r\n        if (obj && p) {\r\n            CmpxLib.eachProp(p, (item: string, name: string) => obj[name] = item);\r\n        }\r\n        return obj;\r\n    }\r\n}\r\n","import CmpxLib from './cmpxLib';\r\n\r\nexport default class CmpxEvent {\r\n    private events: any[] = [];\r\n\r\n    /**\r\n     * 绑定事件\r\n     * @param fn 绑定事件方法\r\n     */\r\n    on(fn: () => any) {\r\n        this.events.push(fn);\r\n    }\r\n\r\n    /**\r\n     * 解绑事件，如果没有指定方法，解绑所有事件\r\n     * @param fn 解绑事件方法\r\n     */\r\n    off(fn?: () => any) {\r\n        if (fn) {\r\n            let index = CmpxLib.inArray(this.events, fn);\r\n            index >= 0 && this.events.splice(index, 1);\r\n        } else\r\n            this.events = [];\r\n    }\r\n\r\n    /**\r\n     * 触发事件, 返回最后一个事件值, 如果返回false中断事件\r\n     * @param args 触发传入参数\r\n     * @param thisArg this对象\r\n     */\r\n    trigger(args: any[], thisArg: any): any {\r\n        let ret: any;\r\n        CmpxLib.each(this.events, function (item: any) {\r\n            ret = item && this.apply(thisArg, args);\r\n            return ret;\r\n        });\r\n        return ret;\r\n    }\r\n}","import CmpxLib from \"./cmpxLib\";\r\n\r\n/**\r\n * HtmlTag配置\r\n */\r\nexport interface IHtmlTagDefConfig {\r\n  [key: string]: HtmlTagDef\r\n}\r\n\r\n/**\r\n * 创建element的属性\r\n */\r\nexport interface ICreateElementAttr {\r\n  /**\r\n   * 属性名称\r\n   */\r\n  name: string;\r\n  /**\r\n   * 属性值\r\n   */\r\n  value: string;\r\n  /**\r\n   * 子名称，如：style.color=\"red\", 子名称为color\r\n   */\r\n  subName?: string;\r\n}\r\n\r\n/**\r\n * 默认element创建器\r\n * @param name tagName, eg:div\r\n * @param attrs 属性数据, 只有静态属性，绑定属性不传入为\r\n * @param parent 父element\r\n * @param content 内容, contentType为RAW_TEXT或RAW_TEXT时会传入\r\n */\r\nexport function DEFAULT_CREATEELEMENT(name: string, attrs: ICreateElementAttr[], parent?: HTMLElement, content?: string): HTMLElement {\r\n  let element: HTMLElement = document.createElement(name);\r\n  CmpxLib.each(attrs, function (item: ICreateElementAttr) {\r\n    HtmlDef.getHtmlAttrDef(item.name).setAttribute(element, item.name, item.value, item.subName);\r\n  });\r\n  return element;\r\n}\r\n\r\n//注释标签\r\nlet _noteTagRegex = /\\<\\!--(?:.|\\n|\\r)*?--\\>/gim;\r\n\r\n/**\r\n * HtmlTag定义类\r\n */\r\nexport class HtmlTagDef {\r\n\r\n  /**\r\n   * 单行标签\r\n   */\r\n  single: boolean;\r\n  raw: boolean;\r\n  /**\r\n   * element创建器\r\n   */\r\n  createElement: (name: string, attrs: ICreateElementAttr[], parent?: HTMLElement, content?: string) => HTMLElement;\r\n\r\n  constructor(\r\n    { single = false, raw = false, createElement = null }: {\r\n      single?: boolean;\r\n      raw?: boolean;\r\n      createElement?: (name: string, attrs: ICreateElementAttr[], parent?: HTMLElement, content?: string) => HTMLElement;\r\n    } = {}) {\r\n    this.single = single;\r\n    this.raw = raw;\r\n    this.createElement = createElement || DEFAULT_CREATEELEMENT\r\n  }\r\n\r\n}\r\n\r\nexport const SINGLE_TAG = new HtmlTagDef({ single: true }),\r\n  DEFULE_TAG = new HtmlTagDef();\r\n\r\nvar _htmlTagDefConfig: IHtmlTagDefConfig = {\r\n  'base': SINGLE_TAG,\r\n  'meta': SINGLE_TAG,\r\n  'area': SINGLE_TAG,\r\n  'embed': SINGLE_TAG,\r\n  'link': SINGLE_TAG,\r\n  'img': SINGLE_TAG,\r\n  'input': SINGLE_TAG,\r\n  'param': SINGLE_TAG,\r\n  'hr': SINGLE_TAG,\r\n  'source': SINGLE_TAG,\r\n  'track': SINGLE_TAG,\r\n  'wbr': SINGLE_TAG,\r\n  'p': DEFULE_TAG,\r\n  'thead': DEFULE_TAG,\r\n  'tbody': DEFULE_TAG,\r\n  'tfoot': DEFULE_TAG,\r\n  'tr': DEFULE_TAG,\r\n  'td': DEFULE_TAG,\r\n  'th': DEFULE_TAG,\r\n  'col': SINGLE_TAG,\r\n  'li': DEFULE_TAG,\r\n  'dt': DEFULE_TAG,\r\n  'dd': DEFULE_TAG,\r\n  'rb': DEFULE_TAG,\r\n  'rt': DEFULE_TAG,\r\n  'rtc': DEFULE_TAG,\r\n  'rp': DEFULE_TAG,\r\n  'optgroup': DEFULE_TAG,\r\n  'option': DEFULE_TAG,\r\n  'pre': DEFULE_TAG,\r\n  'listing': DEFULE_TAG\r\n};\r\n\r\nlet _rawContentRegex: RegExp,\r\n  _escContentRegex: RegExp,\r\n  _removeCmdRegex: RegExp = /\\{\\{((?:.|\\n|\\r)*?)\\}\\}/gmi;\r\n\r\n//删除多余空格\r\nfunction _removeSpace(html: string): string {\r\n  html = html.replace(_removeCmdRegex, function (find: string, content: string) {\r\n    return ['{{', encodeURIComponent(content), '}}'].join('');\r\n  }).replace(_escContentRegex, function (find: string, name: string, attrs: string, content: string, cmdContent: string) {\r\n    return ['<', name, attrs || '', '>', encodeURIComponent(content || ''), '</', name, '>'].join('');\r\n  })\r\n    .replace(/(?:\\n|\\r)+/gmi, ' ').replace(/\\s{2,}/gmi, ' ')\r\n    .replace(_escContentRegex, function (find: string, name: string, attrs: string, content: string, cmdContent: string) {\r\n      return ['<', name, attrs || '', '>', decodeURIComponent(content || ''), '</', name, '>'].join('');\r\n    }).replace(_removeCmdRegex, function (find: string, content: string) {\r\n      return ['{{', decodeURIComponent(content), '}}'].join('');\r\n    });\r\n\r\n  return html;\r\n}\r\n\r\n/**\r\n * HtmlAttr定义\r\n */\r\nexport interface IHtmlAttrDef {\r\n  setAttribute: (element: HTMLElement, name: string, value: string, subName?: string) => void;\r\n  getAttribute: (element: HTMLElement, name: string, subName?: string) => string;\r\n  writeable: boolean;\r\n}\r\n\r\n/**\r\n * 默认HtmlAttr定义\r\n */\r\nexport const DEFAULT_ATTR: IHtmlAttrDef = {\r\n  setAttribute(element: HTMLElement, name: string, value: string, subName?: string) {\r\n    if (subName)\r\n      element[name][subName] = value;\r\n    else\r\n      element.setAttribute(name, value);\r\n  },\r\n  getAttribute(element: HTMLElement, name: string, subName?: string) {\r\n    if (subName)\r\n      return element[name][subName];\r\n    else\r\n      return element.getAttribute(name);\r\n  },\r\n  writeable: false\r\n};\r\n\r\n/**\r\n * 默认HtmlAttr prop定义\r\n */\r\nexport const DEFAULT_ATTR_PROP: IHtmlAttrDef = {\r\n  setAttribute(element: HTMLElement, name: string, value: string, subName?: string) {\r\n    if (subName)\r\n      element[name][subName] = value;\r\n    else\r\n      element[name] = value;\r\n  },\r\n  getAttribute(element: HTMLElement, name: string, subName?: string) {\r\n    if (subName)\r\n      return element[name][subName];\r\n    else\r\n      return element[name];\r\n  },\r\n  writeable: true\r\n};\r\n\r\n/**\r\n * HtmlAttr配置\r\n */\r\nexport interface IHtmlAttrDefConfig {\r\n  [name: string]: IHtmlAttrDef;\r\n}\r\n\r\nvar _htmlAttrDefConfig: IHtmlAttrDefConfig = {\r\n  'src': DEFAULT_ATTR_PROP,\r\n  'rel': DEFAULT_ATTR_PROP,\r\n  'style': DEFAULT_ATTR_PROP,\r\n  'selected': DEFAULT_ATTR_PROP,\r\n  'disabled': DEFAULT_ATTR_PROP,\r\n  'checked': DEFAULT_ATTR_PROP\r\n};\r\n\r\nexport interface IHtmlEventDef {\r\n  addEventListener: (element: HTMLElement, eventName: string, context: (event: any) => any, useCapture: boolean) => void;\r\n  removeEventListener: (element: HTMLElement, eventName: string, context: (event: any) => any, useCapture: boolean) => void;\r\n}\r\n\r\n/**\r\n * 默认事件定义\r\n */\r\nexport const DEFAULT_EVENT_DEF: IHtmlEventDef = {\r\n  addEventListener(element: HTMLElement, eventName: string, context: (event: any) => any, useCapture: boolean) {\r\n    element.addEventListener(eventName, context, useCapture);\r\n    //attachEvent\r\n  },\r\n  removeEventListener(element: HTMLElement, eventName: string, context: (event: any) => any, useCapture: boolean) {\r\n    element.addEventListener(eventName, context, useCapture);\r\n    //detachEvent\r\n  }\r\n};\r\n\r\n/**\r\n * 事件配置\r\n */\r\nexport interface IHtmlEventDefConfig {\r\n  [name: string]: IHtmlEventDef;\r\n}\r\n\r\n\r\nvar _htmlEventDefConfig: IHtmlEventDefConfig = {};\r\n\r\n\r\nexport class HtmlDef {\r\n\r\n  /**\r\n   * 获取标签定义\r\n   * @param tagName 标签名称\r\n   */\r\n  static getHtmlTagDef(tagName: string): HtmlTagDef {\r\n    return _htmlTagDefConfig[tagName.toLowerCase()] || DEFULE_TAG;\r\n  }\r\n\r\n  /**\r\n   * 扩展标签定义\r\n   * @param p 标签配置\r\n   */\r\n  static extendHtmlTagDef(p: IHtmlTagDefConfig): void {\r\n    CmpxLib.extend(_htmlTagDefConfig, p);\r\n    _makeSpecTags();\r\n  }\r\n\r\n  /**\r\n   * 获取属性定义\r\n   * @param name \r\n   */\r\n  static getHtmlAttrDef(name: string): IHtmlAttrDef {\r\n    return _htmlAttrDefConfig[name] || DEFAULT_ATTR;\r\n  }\r\n\r\n  /**\r\n   * 扩展属性定义\r\n   * @param p \r\n   */\r\n  static extendHtmlAttrDef(p: IHtmlAttrDefConfig): void {\r\n    CmpxLib.extend(_htmlAttrDefConfig, p);\r\n  }\r\n\r\n  static getHtmlEventDef(name: string): IHtmlEventDef {\r\n    return _htmlEventDefConfig[name] || DEFAULT_EVENT_DEF;\r\n  }\r\n\r\n  /**\r\n   * 扩展事件定义\r\n   * @param p \r\n   */\r\n  static extendHtmlEventDef(p: IHtmlEventDefConfig): void {\r\n    CmpxLib.extend(_htmlEventDefConfig, p);\r\n  }\r\n\r\n  // /**\r\n  //  * 单行标签\r\n  //  */\r\n  // static singleTags: { [name: string]: boolean };\r\n  // /**\r\n  //  * 内容标签，不解释内容\r\n  //  */\r\n  // static rawTags: { [name: string]: boolean };\r\n\r\n  /**\r\n   * 处理tag内容，删除多余空格，删除注释，编码某些类型内容\r\n   * @param html \r\n   */\r\n  static handleTagContent(html: string): string {\r\n    return _removeSpace(html.replace(_noteTagRegex, ''))\r\n      .replace(_rawContentRegex, function (find: string, name: string, attrs: string, content: string) {\r\n        return ['<', name, attrs || '', '>', CmpxLib.encodeHtml(content || ''), '</', name, '>'].join('');\r\n      });\r\n  }\r\n\r\n}\r\n\r\n\r\nfunction _makeSpecTags() {\r\n  let rawTags = [];\r\n  CmpxLib.eachProp(_htmlTagDefConfig, (item: HtmlTagDef, name: string) => {\r\n    item.raw && rawTags.push(name);\r\n  });\r\n  // let o = HtmlDef.singleTags = {};\r\n  // CmpxLib.each(singleTags, (name: string) => o[name] = true);\r\n  // o = HtmlDef.rawTags = {};\r\n  // CmpxLib.each(rawTags, (name: string) => o[name] = true);\r\n  // o = HtmlDef.escapeRawTags = {};\r\n  // CmpxLib.each(escapeRawTags, (name: string) => o[name] = true);\r\n\r\n  let rawNames = rawTags.join('|');\r\n  _rawContentRegex = new RegExp('<\\\\s*(' + rawNames + ')(\\\\s+(?:[^>]*))*>((?:.|\\\\n|\\\\r)*?)<\\\\s*/\\\\s*\\\\1\\\\s*>', 'gmi');\r\n  rawNames = [rawNames, 'pre'].join('|');\r\n  _escContentRegex = new RegExp('<\\\\s*(' + rawNames + ')(\\\\s+(?:[^>]*))*>((?:.|\\\\n|\\\\r)*?)<\\\\s*/\\\\s*\\\\1\\\\s*>', 'gmi');\r\n}\r\n\r\n_makeSpecTags();\r\n","import CmpxLib from './cmpxLib';\r\nimport { HtmlDef, HtmlTagDef, IHtmlAttrDef, ICreateElementAttr } from './htmlDef';\r\nimport { Componet } from './componet';\r\nimport CmpxEvent from './cmpxEvent';\r\n\r\n\r\nvar _undef: any;\r\n\r\ninterface IBindInfo {\r\n    type: string;\r\n    content: string;\r\n}\r\n\r\n/**\r\n * 标签信息\r\n */\r\ninterface ITagInfo {\r\n    tagName: string;\r\n    //是否标签，如：<div>\r\n    target: boolean;\r\n    //是否指令，如：{{for}}\r\n    cmd: boolean;\r\n    find: string;\r\n    content: string;\r\n    attrs: Array<IAttrInfo>;\r\n    end: boolean;\r\n    single: boolean;\r\n    index: number;\r\n    //是否为绑定\r\n    bind?: boolean;\r\n    bindInfo?: IBindInfo;\r\n    children?: Array<ITagInfo>;\r\n    parent?: ITagInfo;\r\n    componet?: boolean;\r\n    htmlTagDef?: HtmlTagDef;\r\n}\r\n\r\n\r\n/**\r\n * 属性信息\r\n */\r\ninterface IAttrInfo {\r\n    name: string;\r\n    value: string;\r\n    bind: boolean;\r\n    bindInfo?: IBindInfo;\r\n    extend?: any;\r\n}\r\n\r\n//新建一个text节点\r\nvar _newTextContent = function (tmpl: string, start: number, end: number): ITagInfo {\r\n    var text = tmpl.substring(start, end),\r\n        bind = _cmdDecodeAttrRegex.test(text),\r\n        bindInfo: IBindInfo = bind ? _getBind(text, '\"') : null;\r\n    return {\r\n        tagName: '',\r\n        target: false,\r\n        cmd: false,\r\n        find: text,\r\n        content: bind ? \"\" : text,\r\n        attrs: null,\r\n        end: true,\r\n        single: true,\r\n        index: start,\r\n        bind: bind,\r\n        bindInfo: bindInfo\r\n    };\r\n},\r\n    _singleCmd = {\r\n        'include': true\r\n    },\r\n    _encodeURIComponentEx = function (s: string): string {\r\n        return encodeURIComponent(s).replace(/'/g, '%27');\r\n    },\r\n    //将{{this.name}}绑定标签转成$($this.name$)$\r\n    _cmdEncodeAttrRegex = /\\{\\{((?!\\/|\\s*(?:if|else|for|tmpl|include|html)[ \\}])(?:.|\\r|\\n)+?)\\}\\}/gm,\r\n    _makeTextTag = function (tmpl: string): string {\r\n        //\r\n        return tmpl.replace(_cmdEncodeAttrRegex, function (find, content) {\r\n            return ['$($', _encodeURIComponentEx(content), '$)$'].join('');\r\n        });\r\n    },\r\n    //把$($this.name$)$还原\r\n    _cmdDecodeAttrRegex = /\\$\\(\\$(.+?)\\$\\)\\$/gm,\r\n    _backTextTag = function (tmpl: string): string {\r\n        //\r\n        return tmpl.replace(_cmdDecodeAttrRegex, function (find, content) {\r\n            return ['{{', decodeURIComponent(content), '}}'].join('');\r\n        });\r\n    },\r\n    //查找分析tag和cmd\r\n    _tagInfoRegex = /\\<\\s*(\\/*)\\s*([^<>\\s]+)\\s*([^<>]*?)(\\/*)\\s*\\>|\\{\\{\\s*(\\/*)\\s*([^\\s\\{\\}]+)\\s*(.*?)(\\/*)\\}\\}/gim,\r\n    _makeTagInfos = function (tmpl: string): Array<ITagInfo> {\r\n        var lastIndex = 0, list: Array<ITagInfo> = [];\r\n\r\n        tmpl = _makeTextTag(tmpl);\r\n        tmpl = HtmlDef.handleTagContent(tmpl);\r\n        tmpl.replace(_tagInfoRegex, function (find: string, end1: string, tagName: string,\r\n            tagContent: string, end2: string, txtEnd1: string, txtName: string, txtContent: string, txtEnd2: string, index: number) {\r\n\r\n            if (index > lastIndex) {\r\n                list.push(_newTextContent(tmpl, lastIndex, index));\r\n            }\r\n\r\n            var cmd = !!txtName,\r\n                htmlTagDef = cmd ? null : HtmlDef.getHtmlTagDef(tagName),\r\n                single = !!end2 || !!txtEnd2 || (cmd ? _singleCmd[txtName] : htmlTagDef.single),\r\n                end = !!end1 || !!txtEnd1 || single;\r\n\r\n            if (cmd || !(single && !!end1)) {\r\n\r\n                var attrs = !cmd && !!tagContent ? _getAttrInfos(tagContent) : null;\r\n                if (cmd) {\r\n                    if ((single || !end)) {\r\n                        switch (txtName) {\r\n                            case 'for':\r\n                                attrs = _getForAttrInfos(txtContent);\r\n                                break;\r\n                            case 'tmpl':\r\n                            case 'include':\r\n                                attrs = _getAttrInfos(txtContent);\r\n                                break;\r\n                        }\r\n                    }\r\n                } else {\r\n                    attrs = !!tagContent ? _getAttrInfos(tagContent) : null;\r\n                }\r\n\r\n                var item: ITagInfo = {\r\n                    tagName: (tagName || txtName).toLowerCase(),\r\n                    target: !cmd,\r\n                    cmd: cmd,\r\n                    find: find,\r\n                    content: tagContent || txtContent,\r\n                    attrs: attrs,\r\n                    end: end,\r\n                    single: single,\r\n                    index: index,\r\n                    htmlTagDef: htmlTagDef,\r\n                    componet: cmd ? false : !!_registerVM[tagName]\r\n                };\r\n                list.push(item);\r\n            }\r\n\r\n            lastIndex = index + find.length;\r\n\r\n            return find;\r\n        });\r\n        var index = tmpl.length;\r\n        if (index > lastIndex) {\r\n            list.push(_newTextContent(tmpl, lastIndex, index));\r\n        }\r\n        var outList: Array<ITagInfo> = [];\r\n        _makeTagInfoChildren(list, outList, list.length);\r\n        return outList;\r\n    },\r\n    //获取attrInfo\r\n    _attrInfoRegex = /\\s*([^= ]+)\\s*=\\s*(?:([\"'])((?:.|\\n|\\r)*?)\\2|([^\"' ><]*))|\\s*([^= /]+)\\s*/gm,\r\n    _getAttrInfos = function (content: string): Array<IAttrInfo> {\r\n        var attrs: Array<IAttrInfo> = [];\r\n        content.replace(_attrInfoRegex, function (find: string, name: string, split: string,\r\n            value: string, value1: string, name1: string, index: number) {\r\n            value1 && (split = \"\\\"\", value = value1);\r\n            var bind = _cmdDecodeAttrRegex.test(value),\r\n                bindInfo = bind ? _getBind(value, split) : null;\r\n            attrs.push({\r\n                name: (name || name1).toLowerCase(),\r\n                value: value,\r\n                bind: bind,\r\n                bindInfo: bindInfo\r\n            });\r\n            return find;\r\n        });\r\n        return attrs;\r\n    },\r\n    //获取cmd form attrInfo\r\n    //_forAttrRegex = /\\s*([^\\s]+)\\s*\\in\\s*([^\\s]+)\\s*(?:\\s*tmpl\\s*=\\s*([\\'\\\"])(.*?)\\3)*/i,\r\n    _forAttrRegex = /\\s*([^\\s]+)\\s*\\in\\s*([^\\s]+)\\s*/i,\r\n    _getForAttrInfos = function (content: string): Array<IAttrInfo> {\r\n        var extend = _forAttrRegex.exec(content);\r\n        var attrs: Array<IAttrInfo> = [{\r\n            name: '',\r\n            value: '',\r\n            bind: true,\r\n            extend: {\r\n                item: extend[1],\r\n                datas: extend[2],\r\n                tmpl: extend[4]\r\n            }\r\n        }];\r\n        return attrs;\r\n    },\r\n    _bindTypeRegex = /^\\s*([\\<\\>\\:\\@\\#])\\s*(.*)/,\r\n    _removeEmptySplitRegex = /^['\"]{2,2}\\+|\\+['\"]{2,2}/g,\r\n    //获取内容绑定信息，如 name=\"aaa{{this.name}}\"\r\n    _getBind = function (value: string, split: string): IBindInfo {\r\n        let write: string, event: string,\r\n            onceList = [], read: boolean = false, isOnce: boolean = false;\r\n        let type: string = '', txt: string, reg: any, readContent: string = [split, value.replace(_cmdDecodeAttrRegex, function (find: string, content: string, index: number) {\r\n            content = decodeURIComponent(content);\r\n            reg = _bindTypeRegex.exec(content);\r\n            if (reg) {\r\n                type = reg[1];\r\n                txt = reg[2];\r\n            } else {\r\n                type = '';\r\n                txt = content;\r\n            }\r\n            let readTxt = '';\r\n            switch (type) {\r\n                case ':'://一次只读\r\n                    onceList.push(txt);\r\n                    isOnce = true;\r\n                    readTxt = [split, 'once' + (onceList.length - 1), split].join('+');\r\n                    break;\r\n                case '@'://事件\r\n                    event = txt;\r\n                    break;\r\n                case '>'://只写\r\n                    write = txt;\r\n                    break;\r\n                case '#'://读写\r\n                    write = txt;\r\n                case '<'://只读\r\n                default:\r\n                    read = true;\r\n                    readTxt = [split, 'CmpxLib.toStr(' + txt + ')', split].join('+');\r\n                    break;\r\n            }\r\n            return readTxt;\r\n        }), split].join('');\r\n        readContent = readContent.replace(_removeEmptySplitRegex, '');\r\n        // if (isSingeBind)\r\n        //     readContent = readContent.replace(_removeEmptySplitRegex, '');\r\n        //     //readContent = readContentSg;\r\n        // if (isSingeBind) console.log('isSingeBind', readContent);\r\n\r\n        var once: string;\r\n        if (write || read || isOnce || onceList.length > 0) {\r\n            if (isOnce) {\r\n                let oList = [];\r\n                CmpxLib.each(onceList, function (item: string, index: number) {\r\n                    oList.push(['once', index, ' = CmpxLib.toStr(', item, ')'].join(''));\r\n                });\r\n                once = 'var ' + oList.join(',') + ';';\r\n            }\r\n            write && (write = 'function(val){ ' + write + ' = val; }');\r\n            event = null;\r\n        } else if (event) {\r\n            event = 'function(event){ ' + event + '; }';\r\n        }\r\n\r\n        readContent = `(function(){\r\n  ${once ? once : ''}\r\n  return {\r\n    once:${once ? (read ? 'false' : 'true') : 'false'},\r\n    read:${read || isOnce ? 'function(){ return ' + readContent + '; }' : 'null'},\r\n    write:${write ? write : 'null'},\r\n    event:${event ? event : 'null'}\r\n  };\r\n}).call(componet)`;\r\n\r\n        return { type: type, content: readContent };\r\n    },\r\n    _makeTagInfoChildren = function (attrs: Array<ITagInfo>, outList: Array<ITagInfo>,\r\n        len: number, index: number = 0, parent: ITagInfo = null): number {\r\n        var item: ITagInfo;\r\n        while (index < len) {\r\n            item = attrs[index++];\r\n            if (item.cmd || item.target) {\r\n                if (item.single)\r\n                    outList.push(item);\r\n                else if (item.end) {\r\n                    break;\r\n                } else {\r\n                    outList.push(item);\r\n                    item.children = [];\r\n                    index = _makeTagInfoChildren(attrs, item.children, len, index, item);\r\n                    if (item && item.cmd && item.tagName == 'else')\r\n                        break;\r\n                }\r\n            } else {\r\n                outList.push(item);\r\n            }\r\n        }\r\n        return index;\r\n    };\r\n\r\n\r\nexport interface IVMConfig {\r\n    //标签名称\r\n    name: string;\r\n    //模板，可以编译后的function, 如果有配置tmplUrl, 优先使用tmplUrl\r\n    tmpl?: string | Function;\r\n    //模板url，可以编译后的function，如果加载失败使用tmpl内容\r\n    tmplUrl?: string | Function;\r\n    //样式文本, 可以和sytleUrl同时使用\r\n    style?: string;\r\n    //样式url, 可以和sytle同时使用\r\n    styleUrl?: string;\r\n}\r\n\r\ninterface IVM {\r\n    render: CompileRender;\r\n    componetDef: Function\r\n}\r\n\r\nvar _registerVM: { [selector: string]: IVM } = {},\r\n    _vmName = '__vm__',\r\n    _getVmConfig = function (componetDef: any): IVMConfig {\r\n        return componetDef.prototype[_vmName];\r\n    },\r\n    _getVmByComponetDef = function (componetDef: any): { render: CompileRender, componetDef: Function } {\r\n        var config = _getVmConfig(componetDef);\r\n        return config ? _registerVM[config.name] : null;\r\n    },\r\n    _readyRd = false,\r\n    _renderPR = [];\r\n\r\n/**\r\n * 注入组件配置信息\r\n * @param config \r\n */\r\nexport function VM(vm: IVMConfig) {\r\n    return function (constructor: Function) {\r\n        _registerVM[vm.name] = {\r\n            render: null,\r\n            componetDef: constructor\r\n        };\r\n        var rdF = function () {\r\n            _registerVM[vm.name].render = new CompileRender(vm.tmpl, constructor);\r\n            let head = document.head;\r\n            if (vm.style) {\r\n                head.appendChild(HtmlDef.getHtmlTagDef('style').createElement('style', [{\r\n                    name: 'type', value: 'text/css'\r\n                }], head, vm.style));\r\n            }\r\n            if (vm.styleUrl) {\r\n                head.appendChild(HtmlDef.getHtmlTagDef('link').createElement('link', [{\r\n                    name: 'rel', value: 'stylesheet'\r\n                }, {\r\n                    name: 'href', value: vm.styleUrl\r\n                }], head, vm.style));\r\n            }\r\n            //优先tmplUrl\r\n            let tmplUrl: any = vm.tmplUrl;\r\n            if (CmpxLib.isString(tmplUrl) && _loadTmplFn) {\r\n                _tmplCount++;\r\n                _loadTmplFn(tmplUrl, function (tmpl: string | Function) {\r\n                    _registerVM[vm.name].render = new CompileRender(tmpl || vm.tmpl || '', constructor);\r\n                    _tmplCount--;\r\n                    _tmplChk();\r\n                });\r\n            } else\r\n                _registerVM[vm.name].render = new CompileRender(tmplUrl || vm.tmpl || '', constructor);\r\n        };\r\n        _readyRd ? rdF() : _renderPR.push(rdF);\r\n        constructor.prototype.$name = vm.name;\r\n        constructor.prototype[_vmName] = vm;\r\n    };\r\n}\r\n\r\nlet _tmplCount = 0, _tmplFnList = [], _tmplLoaded = function (callback) {\r\n    if (_tmplCount == 0)\r\n        callback && callback();\r\n    else\r\n        callback && _tmplFnList.push(callback);\r\n}, _tmplChk = function () {\r\n    (_tmplCount == 0) && CmpxLib.each(_tmplFnList, function (item: any) {\r\n        console.log('aaa');\r\n        item();\r\n    });\r\n};\r\n\r\ninterface IViewvarDef {\r\n    name: string;\r\n    propKey: string;\r\n}\r\nvar _viewvarName = '__viewvar__',\r\n    _getViewvarDef = function (componet: Componet): IViewvarDef[] {\r\n        return componet[_viewvarName];\r\n    };\r\n/**\r\n * 引用模板变量$var\r\n * @param name 变量名称，未指定为属性名称\r\n */\r\nexport function viewvar(name?: string) {\r\n    return function (componet: Componet, propKey: string) {\r\n        name || (name = propKey);\r\n        var vv: IViewvarDef[] = (componet[_viewvarName] || (componet[_viewvarName] = []));\r\n        vv.push({\r\n            name: name || propKey,\r\n            propKey: propKey\r\n        });\r\n    }\r\n}\r\n\r\nexport interface ISubscribeEvent {\r\n    componet: Componet;\r\n    param?: any;\r\n}\r\n\r\nexport interface ISubscribeParam {\r\n    //视图初始化\r\n    init?: (p: ISubscribeEvent) => void;\r\n    //更新视图\r\n    update?: (p: ISubscribeEvent) => void;\r\n    //更新视图之后\r\n    updateAfter?: (p: ISubscribeEvent) => void;\r\n    //节点插入dom之后\r\n    insertDoc?: (p: ISubscribeEvent) => void;\r\n    //视图准备好\r\n    ready?: (p: ISubscribeEvent) => void;\r\n    //节点或视图删除\r\n    remove?: (p: ISubscribeEvent) => void;\r\n    isRemove?: boolean;\r\n}\r\n\r\nexport class CompileSubject {\r\n    private datas: Array<ISubscribeParam> = [];\r\n\r\n    constructor(subject?: CompileSubject, exclude?: { [type: string]: boolean }) {\r\n        if (subject) {\r\n            if (!(this.isRemove = subject.isRemove)) {\r\n                this.linkParam = subject.subscribe({\r\n                    init: (p: ISubscribeEvent) => (!exclude || !exclude.init) && this.init(p),\r\n                    update: (p: ISubscribeEvent) => (!exclude || !exclude.update) && this.update(p),\r\n                    insertDoc: (p: ISubscribeEvent) => (!exclude || !exclude.insertDoc) && this.insertDoc(p),\r\n                    ready: (p: ISubscribeEvent) => (!exclude || !exclude.ready) && this.ready(p),\r\n                    remove: (p: ISubscribeEvent) => (!exclude || !exclude.remove) && this.remove(p)\r\n                });\r\n                this.subject = subject;\r\n                this.isInit = subject.isInit;\r\n                this.lastInitP = subject.lastInitP;\r\n            }\r\n        }\r\n    }\r\n\r\n    subscribe(p: ISubscribeParam): ISubscribeParam {\r\n        if (!this.isRemove) {\r\n            this.datas.push(p);\r\n            if (this.isInit)\r\n                p.init && (p.init(this.lastInitP), p.init = null);\r\n        }\r\n        return p;\r\n    }\r\n\r\n    unSubscribe(p: ISubscribeParam): void {\r\n        let index = this.datas.indexOf(p);\r\n        if (index >= 0)\r\n            this.datas.splice(index, 1);\r\n    }\r\n\r\n    private linkParam: ISubscribeParam;\r\n    private subject: CompileSubject;\r\n    unLinkSubject(): CompileSubject {\r\n        this.subject && this.subject.unSubscribe(this.linkParam);\r\n        return this;\r\n    }\r\n\r\n    isInit: boolean = false;\r\n    lastInitP: any;\r\n    init(p: ISubscribeEvent) {\r\n        if (this.isRemove) return;\r\n        this.isInit = true;\r\n        this.lastInitP = p;\r\n        CmpxLib.each(this.datas, function (item: ISubscribeParam) {\r\n            if (item.init) {\r\n                item.init(p);\r\n                item.init = null;\r\n            }\r\n        });\r\n    }\r\n\r\n    update(p: ISubscribeEvent) {\r\n        if (this.isRemove) return;\r\n        CmpxLib.each(this.datas, function (item: ISubscribeParam) {\r\n            if (item.update) {\r\n                item.update && item.update(p);\r\n            }\r\n        });\r\n        this.updateAfter(p);\r\n    }\r\n\r\n    private updateAfter(p: ISubscribeEvent) {\r\n        if (this.isRemove) return;\r\n        CmpxLib.each(this.datas, function (item: ISubscribeParam) {\r\n            if (item.updateAfter) {\r\n                item.updateAfter && item.updateAfter(p);\r\n            }\r\n        });\r\n    }\r\n\r\n    insertDoc(p: ISubscribeEvent) {\r\n        if (this.isRemove) return;\r\n        CmpxLib.each(this.datas, function (item: ISubscribeParam) {\r\n            if (item.insertDoc) {\r\n                item.insertDoc(p);\r\n                item.insertDoc = null;\r\n            }\r\n        });\r\n    }\r\n\r\n    ready(p: ISubscribeEvent) {\r\n        if (this.isRemove) return;\r\n        CmpxLib.each(this.datas, function (item: ISubscribeParam) {\r\n            if (item.ready) {\r\n                item.ready(p);\r\n                item.ready = null;\r\n            }\r\n        });\r\n    }\r\n\r\n    isRemove: boolean = false;\r\n    remove(p: ISubscribeEvent) {\r\n        if (this.isRemove) return;\r\n        this.isRemove = true;\r\n        this.unLinkSubject();\r\n        var datas = this.datas;\r\n        this.datas = [];\r\n        CmpxLib.each(datas, function (item: ISubscribeParam) {\r\n            if (item.remove) {\r\n                item.remove(p);\r\n                item.remove = null;\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\nlet _tmplName = '__tmpl__',\r\n    _getComponetTmpl = function (componet: Componet, id: string): any {\r\n        let tmpls = componet[_tmplName];\r\n        if (!tmpls || !tmpls[id])\r\n            return componet.$parent ? _getComponetTmpl(componet.$parent, id) : null;\r\n        else\r\n            return tmpls[id];\r\n    },\r\n    _insertAfter = function (newElement: Node, refElement: Node, parent: Node) {\r\n        let nextSibling = refElement.nextSibling;\r\n        if (nextSibling) {\r\n            parent.insertBefore(newElement, nextSibling);\r\n        } else\r\n            parent.appendChild(newElement);\r\n    },\r\n    _createTempNode = function (): Node {\r\n        return document.createTextNode('');\r\n        // let element:Node = document.createElement('script');\r\n        // element['type'] = 'text/html';\r\n        // return element;\r\n    },\r\n    _getRefNode = function (parentNode: Node, insertTemp: boolean): { refNode: Node, isInsertTemp: boolean } {\r\n        var tNode: Node;\r\n        if (insertTemp) {\r\n            tNode = _createTempNode();\r\n            parentNode.appendChild(tNode);\r\n        } else {\r\n            tNode = parentNode.lastChild;\r\n            if (!tNode) {\r\n                insertTemp = true;\r\n                tNode = _createTempNode();\r\n                parentNode.appendChild(tNode);\r\n            }\r\n        }\r\n        //注意tmplElement是Comment, 在IE里只能取到parentNode\r\n        return { refNode: tNode, isInsertTemp: insertTemp };\r\n    },\r\n    _equalArrayIn = function (array1: Array<any>, array2: Array<any>) {\r\n        var ok = true;\r\n        CmpxLib.each(array1, function (item, index) {\r\n            if (item != array2[index]) {\r\n                ok = false; return false;\r\n            }\r\n        });\r\n        return ok;\r\n    },\r\n    _equalArray = function (array1: Array<any>, array2: Array<any>): boolean {\r\n        if ((!array1 || !array2)) return array1 == array2;\r\n\r\n        return array1.length == array2.length && _equalArrayIn(array1, array2);\r\n    },\r\n    _getParentElement = function (node: Node): HTMLElement {\r\n        return node.parentElement || (node.parentNode as HTMLElement);\r\n    },\r\n    _removeChildNodes = function (childNodes: Node[]) {\r\n        if (childNodes && childNodes.length > 0) {\r\n            let pNode: Node;\r\n            CmpxLib.each(childNodes, function (item: Node) {\r\n                (pNode = _getParentElement(item)) && pNode.removeChild(item);\r\n            });\r\n        }\r\n        return null;\r\n    };\r\n\r\nexport class CompileRender {\r\n\r\n    /**\r\n     * 编译的结果，Function\r\n     */\r\n    readonly contextFn: Function;\r\n    private componetDef: any;\r\n    private param: Object;\r\n\r\n    /**\r\n     * \r\n     * @param tmpl html模板文本\r\n     * @param componetDef 组件定义类，如果没有传为临时模板\r\n     */\r\n    constructor(context: any, componetDef?: Componet | Function, param?: Object) {\r\n        this.componetDef = componetDef;\r\n        this.param = param;\r\n        let fn: any;\r\n        if (CmpxLib.isString(context)) {\r\n            let tagInfos = _makeTagInfos(CmpxLib.trim(context, true));\r\n            fn = _buildCompileFn(tagInfos, param);\r\n            //console.log(tagInfos);\r\n        } else\r\n            fn = context;\r\n\r\n        // console.log(fn.toString());\r\n\r\n        this.contextFn = fn;\r\n    }\r\n\r\n    /**\r\n     * 编译并插入到document\r\n     * @param refElement 在element之后插入内容\r\n     * @param parentComponet 父组件\r\n     */\r\n    complie(refNode: Node, parentComponet?: Componet, subject?: CompileSubject, contextFn?: (component: Componet, element: HTMLElement, subject: CompileSubject) => void, subjectExclude?: { [type: string]: boolean }): { newSubject: CompileSubject, refComponet: Componet } {\r\n        var componetDef: any = this.componetDef;\r\n\r\n        subject || (subject = (parentComponet ? parentComponet.$subObject : null));\r\n        subjectExclude || (subjectExclude = {});\r\n        //subjectExclude.remove = true;\r\n        subjectExclude.insertDoc = true;\r\n\r\n        let componet: any,\r\n            isNewComponet: boolean = false,\r\n            parentElement: HTMLElement = _getParentElement(refNode),\r\n            newSubject: CompileSubject = new CompileSubject(subject, subjectExclude);\r\n        if (componetDef) {\r\n            isNewComponet = true;\r\n            componet = new componetDef();\r\n            componet.$name = name;\r\n            componet.$subObject = newSubject;\r\n            componet.$parentElement = parentElement;\r\n            componet.$parent = parentComponet;\r\n\r\n            parentComponet && parentComponet.$children.push(componet);\r\n\r\n        } else {\r\n            //如果没有componetDef，为临时tmpl\r\n            //传入的parentComponet为当前的componet\r\n            componet = parentComponet;\r\n        }\r\n\r\n        //如果临时tmpl没有parentComponet报错\r\n        if (!componet) {\r\n            throw new Error('render缺少Componet参数');\r\n        }\r\n        //注意parentElement问题，但现在context只能放{{tmpl}}\r\n        contextFn && contextFn(componet, parentElement, newSubject);\r\n\r\n        newSubject.subscribe({\r\n            remove: function (p: ISubscribeEvent) {\r\n                try {\r\n                    isNewComponet && (componet.$isDisposed = true, componet.onDispose());\r\n                    if (p.componet == componet)\r\n                        childNodes = _removeChildNodes(childNodes);\r\n                } catch (e) {\r\n                    CmpxLib.trace(e);\r\n                } finally {\r\n\r\n                    if (isNewComponet) {\r\n                        if (parentComponet && !parentComponet.$isDisposed) {\r\n                            var childs = parentComponet.$children,\r\n                                idx = childs.indexOf(componet);\r\n                            (idx >= 0) && childs.splice(idx, 1);\r\n                        }\r\n\r\n                        componet.$subObject = componet.$children = //componet.$elements =\r\n                            componet.$parent = componet.$parentElement = null;\r\n                    }\r\n                }\r\n            },\r\n            updateAfter: function (p: ISubscribeEvent) {\r\n                isNewComponet && retFn && retFn.call(componet);\r\n\r\n            }\r\n        });\r\n        let childNodes: Node[], retFn;\r\n        let fragment: DocumentFragment, initFn = () => {\r\n            newSubject.init({\r\n                componet: componet\r\n            });\r\n            fragment = document.createDocumentFragment();\r\n            subject && subject.subscribe({\r\n                remove: function (p: ISubscribeEvent) {\r\n                    fragment = refNode = componet = parentElement = parentComponet = null;\r\n                }\r\n            });\r\n            retFn = this.contextFn.call(componet, CmpxLib, Compile, componet, fragment, newSubject, this.param, function (vvList: any[]) {\r\n                if (!vvList || vvList.length == 0) return;\r\n                let vvDef: IViewvarDef[] = _getViewvarDef(this);\r\n                if (!vvDef) return;\r\n                CmpxLib.each(vvDef, function (def: IViewvarDef) {\r\n                    let propKey = def.propKey, name = def.name;\r\n                    CmpxLib.each(vvList, function (item: { name: string, p: any, isL: boolean }) {\r\n                        if (item.name == name) {\r\n                            if (item.isL) {\r\n                                if (!this[propKey] || item.p.length > 0)\r\n                                    this[propKey] = item.p.splice(0);\r\n                            } else\r\n                                this[propKey] = item.p;\r\n                            return false;\r\n                        }\r\n                    }, this);\r\n                }, this);\r\n            });\r\n            newSubject.update({\r\n                componet: componet\r\n            });\r\n            if (isNewComponet) {\r\n                componet.onInitViewvar(readyFn, null);\r\n            }\r\n            else\r\n                readyFn();\r\n        },\r\n            readyFn = function () {\r\n                childNodes = CmpxLib.toArray(fragment.childNodes);\r\n                _insertAfter(fragment, refNode, parentElement);\r\n                newSubject.insertDoc({\r\n                    componet: componet\r\n                });\r\n                isNewComponet && componet.onReady(function () { }, null);\r\n                newSubject.ready({\r\n                    componet: componet\r\n                });\r\n                //reay后再次补发update\r\n                newSubject.update({\r\n                    componet: componet\r\n                });\r\n            };\r\n        if (isNewComponet) {\r\n            componet.onInit(function (err) {\r\n                initFn();\r\n            }, null);\r\n        }\r\n        else\r\n            initFn();\r\n\r\n        return { newSubject: newSubject, refComponet: componet };\r\n    }\r\n}\r\n\r\nlet _loadTmplFn: (url: string, cb: (tmpl: string | Function) => void) => void;\r\n\r\nexport class Compile {\r\n\r\n    /**\r\n     * 编译器启动，用于htmlDef配置后\r\n     */\r\n    public static startUp() {\r\n        if (_readyRd) return;\r\n        _readyRd = true;\r\n        CmpxLib.each(_renderPR, function (item: any) {\r\n            item();\r\n        });\r\n        _renderPR = null;\r\n    }\r\n\r\n    public static loadTmplCfg(loadTmplFn: (url: string, cb: (tmpl: string | Function) => void) => void): void {\r\n        _loadTmplFn = loadTmplFn;\r\n    }\r\n\r\n    public static createComponet(\r\n        name: string, componet: Componet, parentElement: HTMLElement, subject: CompileSubject,\r\n        contextFn: (component: Componet, element: HTMLElement, subject: CompileSubject) => void\r\n    ): void {\r\n        if (subject.isRemove) return;\r\n\r\n        let vm: IVM = _registerVM[name],\r\n            componetDef: any = vm.componetDef,\r\n            { refNode, isInsertTemp } = _getRefNode(parentElement, false);\r\n\r\n        Compile.renderComponet(componetDef, refNode, function () { }, componet, subject, contextFn);\r\n\r\n    }\r\n\r\n    public static setAttributeCP(element: HTMLElement, name: string, content: any, componet: Componet, subject: CompileSubject): void {\r\n        let isObj = !CmpxLib.isString(content),\r\n            parent = componet.$parent;\r\n        if (isObj) {\r\n            let isEvent = !!content.event,\r\n                update;\r\n            if (isEvent) {\r\n                let isBind = false,\r\n                    eventDef = componet[name],\r\n                    eventFn: any = function (args) { return content.event.apply(componet, args); };\r\n                eventDef || (eventDef = componet[name] = new CmpxEvent());\r\n                subject.subscribe({\r\n                    update: function (p: ISubscribeEvent) {\r\n                        if (isBind) return;\r\n                        isBind = true;\r\n                        eventDef.on(eventFn);\r\n                    },\r\n                    remove: function (p: ISubscribeEvent) {\r\n                        isBind && eventDef.off();\r\n                        componet[name] = null;\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                let value: any, newValue: any,\r\n                    isWrite: boolean = !!content.write,\r\n                    isRead: boolean = !!content.read,\r\n                    writeFn = function (p: ISubscribeEvent) {\r\n                        newValue = componet[name];\r\n                        if (value != newValue) {\r\n                            value = newValue;\r\n                            content.write.call(parent, newValue);\r\n                            parent.$updateAsync();\r\n                        }\r\n                    };\r\n                let attrDef: IHtmlAttrDef = HtmlDef.getHtmlAttrDef(name);\r\n                subject.subscribe({\r\n                    update: function (p: ISubscribeEvent) {\r\n                        if (isRead) {\r\n                            newValue = content.read.call(parent);\r\n                            if (value != newValue) {\r\n                                value = newValue;\r\n                                componet[name] = value;\r\n                                componet.$updateAsync();\r\n                            } else if (isWrite) {\r\n                                writeFn(p);\r\n                            }\r\n                        } else if (isWrite) {\r\n                            writeFn(p);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        } else\r\n            componet[name] = content;\r\n    }\r\n\r\n    public static createElement(name: string, attrs: ICreateElementAttr[], componet: Componet, parentElement: HTMLElement, subject: CompileSubject,\r\n        contextFn: (componet: Componet, element: HTMLElement, subject: CompileSubject) => void, content?: string): void {\r\n\r\n        if (subject.isRemove) return;\r\n\r\n        let element: HTMLElement = HtmlDef.getHtmlTagDef(name).createElement(name, attrs, parentElement, content);\r\n        parentElement.appendChild(element);\r\n        contextFn && contextFn(componet, element, subject);\r\n    }\r\n\r\n    public static createTextNode(content: any, componet: Componet, parentElement: HTMLElement, subject: CompileSubject): Text {\r\n        if (subject.isRemove) return;\r\n\r\n        let isObj = !CmpxLib.isString(content),\r\n            value: string = '',\r\n            once: boolean = isObj ? content.once : false,\r\n            readFn = isObj ? 　content.read : null,\r\n            textNode = document.createTextNode(isObj ? (once ? readFn.call(componet) : value) : content);\r\n        parentElement.appendChild(textNode);\r\n        subject.subscribe({\r\n            update: function (p: ISubscribeEvent) {\r\n                if (!once && readFn) {\r\n                    var newValue = readFn.call(componet);\r\n                    if (value != newValue) {\r\n                        value = newValue;\r\n                        textNode[('textContent' in textNode) ? 'textContent' : 'nodeValue'] = newValue;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return textNode;\r\n    }\r\n\r\n    public static setAttribute(element: HTMLElement, name: string, subName: string, content: any, componet: Componet, subject: CompileSubject): void {\r\n        let isObj = !CmpxLib.isString(content);\r\n        if (isObj) {\r\n            let isEvent = !!content.event,\r\n                update, eventDef;\r\n            if (isEvent) {\r\n                let isBind = false,\r\n                    eventFn = function (e) { return content.event.call(componet, event); };\r\n                eventDef = HtmlDef.getHtmlEventDef(name);\r\n                subject.subscribe({\r\n                    update: function (p: ISubscribeEvent) {\r\n                        if (isBind) return;\r\n                        isBind = true;\r\n                        eventDef.addEventListener(element, name, eventFn, false);\r\n                    },\r\n                    remove: function (p: ISubscribeEvent) {\r\n                        if (isBind) {\r\n                            eventDef.removeEventListener(element, name, eventFn, false);\r\n                        }\r\n                    }\r\n                });\r\n\r\n            } else {\r\n                let value: any = '', newValue: any,\r\n                    isWrite: boolean = !!content.write,\r\n                    isRead: boolean = !!content.read,\r\n                    writeFn = function () {\r\n                        newValue = attrDef.getAttribute(element, name);\r\n                        if (value != newValue) {\r\n                            value = newValue;\r\n                            content.write.call(componet, newValue);\r\n                            componet.$updateAsync();\r\n                        }\r\n                    };\r\n\r\n                let attrDef: IHtmlAttrDef = HtmlDef.getHtmlAttrDef(name);\r\n                if (isWrite) {\r\n                    eventDef = HtmlDef.getHtmlEventDef(name);\r\n                    eventDef.addEventListener(element, 'change', writeFn, false);\r\n                    eventDef.addEventListener(element, 'click', writeFn, false);\r\n                }\r\n                subject.subscribe({\r\n                    update: function (p: ISubscribeEvent) {\r\n                        if (isRead) {\r\n                            newValue = content.read.call(componet);\r\n                            if (value != newValue) {\r\n                                value = newValue;\r\n                                attrDef.setAttribute(element, name, value, subName);\r\n                            }\r\n                        }\r\n                    },\r\n                    remove: function (p: ISubscribeEvent) {\r\n                        if (isWrite) {\r\n                            eventDef.removeEventListener(element, 'change', writeFn, false);\r\n                            eventDef.removeEventListener(element, 'click', writeFn, false);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        } else\r\n            HtmlDef.getHtmlAttrDef(name).setAttribute(element, name, content);\r\n    }\r\n\r\n    public static forRender(\r\n        dataFn: (componet: Componet, element: HTMLElement, subject: CompileSubject) => any,\r\n        eachFn: (item: any, count: number, index: number, componet: Componet, element: HTMLElement, subject: CompileSubject) => any,\r\n        componet: Componet, parentElement: HTMLElement, insertTemp: boolean, subject: CompileSubject\r\n    ): void {\r\n\r\n        if (subject.isRemove || !dataFn || !eachFn) return;\r\n\r\n        let { refNode, isInsertTemp } = _getRefNode(parentElement, insertTemp);\r\n\r\n        let value: any, newSubject: CompileSubject;\r\n        let fragment: DocumentFragment, childNodes: Node[], removeFn = function () {\r\n            childNodes = _removeChildNodes(childNodes);\r\n        };\r\n        subject.subscribe({\r\n            update: function (p: ISubscribeEvent) {\r\n                let datas = dataFn.call(componet, componet, parentElement, subject);\r\n                if (!_equalArray(datas, value)) {\r\n                    value = datas;\r\n\r\n                    removeFn();\r\n                    newSubject && newSubject.remove({\r\n                        componet: componet\r\n                    });\r\n\r\n                    newSubject = new CompileSubject(subject, { insertDoc: true });\r\n\r\n                    fragment = document.createDocumentFragment();\r\n                    let count = datas ? datas.length : 0;\r\n                    CmpxLib.each(datas, function (item, index) {\r\n                        eachFn.call(componet, item, count, index, componet, fragment, newSubject);\r\n                    });\r\n                    newSubject.update({\r\n                        componet: componet\r\n                    });\r\n                    childNodes = CmpxLib.toArray(fragment.childNodes);\r\n                    _insertAfter(fragment, refNode, parentElement);\r\n                    newSubject.insertDoc({\r\n                        componet: componet\r\n                    });\r\n                }\r\n            },\r\n            remove: function (p: ISubscribeEvent) {\r\n                removeFn();\r\n                newSubject = fragment = childNodes = refNode = null;\r\n            }\r\n        });\r\n    }\r\n\r\n    public static ifRender(\r\n        ifFun: (componet: Componet, element: HTMLElement, subject: CompileSubject) => any,\r\n        trueFn: (componet: Componet, element: HTMLElement, subject: CompileSubject) => any,\r\n        falseFn: (componet: Componet, element: HTMLElement, subject: CompileSubject) => any,\r\n        componet: Componet, parentElement: HTMLElement, insertTemp: boolean, subject: CompileSubject\r\n    ): void {\r\n\r\n        if (subject.isRemove) return;\r\n\r\n        var { refNode, isInsertTemp } = _getRefNode(parentElement, insertTemp);\r\n\r\n        var value, newSubject: CompileSubject;\r\n        var fragment: DocumentFragment, childNodes: Node[], removeFn = function () {\r\n            childNodes = _removeChildNodes(childNodes);\r\n        };\r\n        subject.subscribe({\r\n            update: function (p: ISubscribeEvent) {\r\n                let newValue = !!ifFun.call(componet, componet, parentElement, subject);\r\n\r\n                if (newValue != value) {\r\n                    value = newValue;\r\n\r\n                    removeFn();\r\n                    newSubject && newSubject.remove({\r\n                        componet: componet\r\n                    });\r\n\r\n                    newSubject = new CompileSubject(subject, { insertDoc: true });\r\n\r\n                    fragment = document.createDocumentFragment();\r\n                    if (newValue)\r\n                        trueFn.call(componet, componet, fragment, newSubject);\r\n                    else\r\n                        falseFn.call(componet, componet, fragment, newSubject);\r\n                    newSubject.update({\r\n                        componet: componet\r\n                    });\r\n                    childNodes = CmpxLib.toArray(fragment.childNodes);\r\n                    _insertAfter(fragment, refNode, _getParentElement(refNode));\r\n                    newSubject.insertDoc({\r\n                        componet: componet\r\n                    });\r\n                }\r\n            },\r\n            remove: function (p: ISubscribeEvent) {\r\n                removeFn();\r\n                newSubject = fragment = childNodes = refNode = null;\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    public static tmplRender(id, componet: Componet, parentElement: HTMLElement, subject: CompileSubject,\r\n        contextFn: (componet: Componet, element: HTMLElement, subject: CompileSubject, param: any) => void): void {\r\n\r\n        if (subject.isRemove) return;\r\n\r\n        var tmpls = componet[_tmplName];\r\n        tmpls || (tmpls = componet[_tmplName] = {});\r\n\r\n        tmpls[id] = function (componet: Componet, element: HTMLElement, subject: CompileSubject, param: any) {\r\n            contextFn && contextFn.call(componet, componet, element, subject, param);\r\n        };\r\n    }\r\n\r\n    public static includeRender(context: any, componet: Componet, parentElement: HTMLElement, insertTemp: boolean, subject: CompileSubject, param: any): void {\r\n        if (!context || subject.isRemove) return;\r\n\r\n        if (CmpxLib.isString(context)) {\r\n            let tmpl = _getComponetTmpl(componet, context);\r\n            tmpl && tmpl.call(componet, componet, parentElement, subject, param || {});\r\n        } else {\r\n            let render: CompileRender,\r\n                preSubject: CompileSubject, preComponet: Componet,\r\n                { refNode, isInsertTemp } = _getRefNode(parentElement, insertTemp);\r\n\r\n            subject.subscribe({\r\n                update: function (p: ISubscribeEvent) {\r\n                    let newRender: CompileRender = context.call(componet);\r\n\r\n                    if (newRender != render) {\r\n                        render = newRender;\r\n\r\n                        preSubject && preSubject.remove({\r\n                            componet: preComponet\r\n                        });\r\n\r\n                        let { newSubject, refComponet } = newRender.complie(refNode, componet, subject);\r\n                        preSubject = newSubject;\r\n                        preComponet = refComponet;\r\n\r\n                    }\r\n                },\r\n                remove: function (p: ISubscribeEvent) {\r\n                    render = null;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    static renderComponet(componetDef: any, refNode: Node,\r\n        complieEnd?: (newSubject: CompileSubject, refComponet: Componet) => void,\r\n        parentComponet?: Componet, subject?: CompileSubject,\r\n        contextFn?: (component: Componet, element: HTMLElement, subject: CompileSubject) => void): void {\r\n\r\n        _tmplLoaded(function () {\r\n            let vm = _getVmByComponetDef(componetDef),\r\n                render = vm && vm.render;\r\n            if (!vm) throw new Error('not find @VM default!');\r\n            let { newSubject, refComponet } = render.complie(refNode, parentComponet, subject, contextFn, { update: true });\r\n            complieEnd && complieEnd.call(refComponet, newSubject, refComponet);\r\n        });\r\n    }\r\n\r\n}\r\n\r\nvar _buildCompileFn = function (tagInfos: Array<ITagInfo>, param?: Object): Function {\r\n    var outList = [], varNameList = [];\r\n\r\n    _buildCompileFnContent(tagInfos, outList, varNameList, true);\r\n\r\n    varNameList.length > 0 && outList.unshift('var ' + varNameList.join(',') + ';');\r\n    param && outList.unshift(_getCompileFnParam(param));\r\n    outList.unshift(`var __tmplRender = Compile.tmplRender,\r\n    __createComponet = Compile.createComponet,\r\n    __setAttributeCP = Compile.setAttributeCP,\r\n    __createElement = Compile.createElement,\r\n    __setAttribute = Compile.setAttribute,\r\n    __createTextNode = Compile.createTextNode,\r\n    __forRender = Compile.forRender,\r\n    __ifRender = Compile.ifRender,\r\n    __includeRender = Compile.includeRender;`);\r\n\r\n    outList.push(_buildCompileFnReturn(varNameList));\r\n\r\n    return new Function('CmpxLib', 'Compile', 'componet', 'element', 'subject', '__p__', 'initViewvar', outList.join('\\n'));\r\n},\r\n    _getCompileFnParam = function (param: Object): string {\r\n        var pList = [];\r\n        CmpxLib.eachProp(param, function (item, name) {\r\n            pList.push([name, ' = ', '__p__.', name].join(''));\r\n        });\r\n        return 'var ' + pList.join(', ') + ';';\r\n    },\r\n    _buildCpFnRetRmRegex = /\\s*\\=\\s*\\[\\s*\\]\\s*$/,\r\n    _buildCompileFnReturn = function (varNameList: string[]): string {\r\n\r\n        if (varNameList.length > 0) {\r\n            let vvList = [], isL: boolean;\r\n            CmpxLib.each(varNameList, function (item) {\r\n                isL = _buildCpFnRetRmRegex.test(item);\r\n                isL && (item = item.replace(_buildCpFnRetRmRegex, ''));\r\n                vvList.push(['{name:\"', item, '\", p:', item, ', isL:', (isL ? 'true' : 'false'), '}'].join(''));\r\n            });\r\n            return 'return function(){initViewvar.call(this, [' + vvList.join(',') + ']);};';\r\n        } else {\r\n            return 'return function(){initViewvar.call(this);};'\r\n        }\r\n    },\r\n    _escapeStringRegex = /([\\\"\\\\])/gm,\r\n    _escapeBuildString = function (s: string): string {\r\n        return s ? s.replace(/([\\\"\\\\])/gm, '\\\\$1').replace(/\\n/gm, '\\\\n').replace(/\\r/gm, '\\\\r') : '';\r\n    },\r\n    _makeSubName = function (name): string[] {\r\n        if (name.indexOf('.') > 0) {\r\n            return name.split('.');\r\n        } else\r\n            return [name, ''];\r\n    },\r\n    _makeElementTag = function (tagName, attrs: Array<IAttrInfo>): { bindAttrs: Array<IAttrInfo>, stAtts: Array<ICreateElementAttr> } {\r\n        var bindAttrs = [], stAtts = [], names: string[];\r\n        CmpxLib.each(attrs, function (item: IAttrInfo) {\r\n            if (item.name == '$var' || item.name == '$array') return;\r\n            if (item.bind)\r\n                bindAttrs.push(item);\r\n            else {\r\n                names = _makeSubName(item.name);\r\n                stAtts.push({ name: names[0], value: _escapeBuildString(item.value), subName: names[1] });\r\n            }\r\n        });\r\n        return { bindAttrs: bindAttrs, stAtts: stAtts };\r\n    },\r\n    _buildAttrContent = function (attrs: Array<IAttrInfo>, outList: Array<string>) {\r\n        if (!attrs) return;\r\n        let names: string[];\r\n        CmpxLib.each(attrs, function (attr: IAttrInfo, index: number) {\r\n            names = _makeSubName(attr.name);\r\n            outList.push('__setAttribute(element, \"' + names[0] + '\", \"' + names[1] + '\", ' + attr.bindInfo.content + ', componet, subject);');\r\n        });\r\n    },\r\n    _buildAttrContentCP = function (attrs: Array<IAttrInfo>, outList: Array<string>) {\r\n        if (!attrs) return;\r\n        CmpxLib.each(attrs, function (attr: IAttrInfo, index: number) {\r\n            if (attr.name == '$var') return;\r\n            if (attr.bind)\r\n                outList.push('__setAttributeCP(element, \"' + attr.name + '\", ' + attr.bindInfo.content + ', componet, subject);');\r\n            else\r\n                outList.push('__setAttributeCP(element, \"' + attr.name + '\", \"' + _escapeBuildString(attr.value) + '\", componet, subject);');\r\n        });\r\n    },\r\n    _getViewvarName = function (attrs: Array<IAttrInfo>): { item: string, list: string } {\r\n        let name = { item: null, list: null }, has = false;\r\n        CmpxLib.each(attrs, function (attr: IAttrInfo, index: number) {\r\n            if (attr.name == '$var') {\r\n                name.item = CmpxLib.trim(attr.value);\r\n                has = true;\r\n                return false;\r\n            } else if (attr.name == '$array') {\r\n                name.list = CmpxLib.trim(attr.value);\r\n                has = true;\r\n                return false;\r\n            }\r\n        });\r\n        return has ? name : null;\r\n    },\r\n    _getInsertTemp = function (preInsert: boolean) {\r\n        return preInsert ? 'true' : 'false';\r\n    },\r\n    _getTagContent = function (tagInfo: ITagInfo): string {\r\n        let content: string;\r\n        CmpxLib.each(tagInfo.children, function (item: ITagInfo) {\r\n            content = CmpxLib.decodeHtml(item.content);\r\n        });\r\n        return content;\r\n    },\r\n    _buildCompileFnForVar = function (itemName: string, outList: string[]) {\r\n\r\n        var str = ['var $last = ($count - $index == 1), ', itemName, '_last = $last, ',\r\n            '$first = ($index ==  0), ', itemName, '_first = $first, ',\r\n            '$odd = ($index % 2 ==  0), ', itemName, '_odd = $odd, ',\r\n            '$even = !$odd, ', itemName, '_even = $even;'].join('');\r\n        outList.push(str);\r\n    },\r\n    _buildCompileFnContent = function (tagInfos: Array<ITagInfo>, outList: Array<string>, varNameList: string[], preInsert: boolean, inclue?: string[]) {\r\n        if (!tagInfos) return;\r\n\r\n        CmpxLib.each(tagInfos, function (tag: ITagInfo, index: number) {\r\n            let tagName = tag.tagName;\r\n            //如果指定include, 非tagName或不包涵，不引入\r\n            if (inclue && (!tagName || inclue.indexOf(tagName) < 0)) return;\r\n            if (!tag.cmd) {\r\n                if (tag.target) {\r\n                    let hasChild: boolean = tag.children && tag.children.length > 0,\r\n                        hasAttr: boolean = tag.attrs && tag.attrs.length > 0,\r\n                        varName = hasAttr ? _getViewvarName(tag.attrs) : null;\r\n                    if (varName) {\r\n                        varName.item && varNameList.push(varName.item);\r\n                        varName.list && varNameList.push(varName.list + ' = []');\r\n                    }\r\n                    if (tag.componet) {\r\n                        if (hasChild || hasAttr || varName) {\r\n                            outList.push('__createComponet(\"' + tagName + '\", componet, element, subject, function (componet, element, subject) {');\r\n                            if (varName) {\r\n                                varName.item && outList.push(varName.item + ' = componet;');\r\n                                varName.list && outList.push(varName.list + '.push(componet);');\r\n                            }\r\n                            _buildAttrContentCP(tag.attrs, outList);\r\n                            //createComponet下只能放tmpl\r\n                            _buildCompileFnContent(tag.children, outList, varNameList, preInsert, ['tmpl']);\r\n                            outList.push('});');\r\n                        } else {\r\n                            outList.push('__createComponet(\"' + tagName + '\", componet, element, subject);');\r\n                        }\r\n                        preInsert = true;\r\n                    } else {\r\n                        let htmlTagDef: HtmlTagDef = tag.htmlTagDef,\r\n                            rawTag = htmlTagDef.raw,\r\n                            tagContent = rawTag && _getTagContent(tag);\r\n                        //如果rawTag没有子级\r\n                        hasChild && (hasChild = !rawTag);\r\n                        if (hasAttr || hasChild || varName) {\r\n\r\n                            let { bindAttrs, stAtts } = _makeElementTag(tagName, tag.attrs);\r\n                            outList.push('__createElement(\"' + tagName + '\", ' + JSON.stringify(stAtts) + ', componet, element, subject, function (componet, element, subject) {');\r\n                            if (varName) {\r\n                                varName.item && outList.push(varName.item + ' = element;');\r\n                                varName.list && outList.push(varName.list + '.push(element);');\r\n                            }\r\n                            _buildAttrContent(bindAttrs, outList);\r\n                            hasChild && _buildCompileFnContent(tag.children, outList, varNameList, preInsert);\r\n\r\n                            outList.push('}, \"' + _escapeBuildString(tagContent) + '\");');\r\n                        } else {\r\n                            outList.push('__createElement(\"' + tagName + '\", [], componet, element, subject, null, \"' + _escapeBuildString(tagContent) + '\");');\r\n                        }\r\n                        preInsert = false;\r\n                    }\r\n                } else {\r\n                    if (tag.bind) {\r\n                        outList.push('__createTextNode(' + tag.bindInfo.content + ', componet, element, subject);');\r\n                    } else\r\n                        outList.push('__createTextNode(\"' + _escapeBuildString(tag.content) + '\", componet, element, subject);');\r\n                    preInsert = false;\r\n                }\r\n            } else {\r\n                switch (tagName) {\r\n                    case 'for':\r\n                        var extend = tag.attrs[0].extend,\r\n                            itemName = extend.item\r\n                        outList.push('__forRender(function (componet, element, subject) {');\r\n                        outList.push('return ' + extend.datas);\r\n                        outList.push('}, function (' + itemName + ', $count, $index, componet, element, subject) {');\r\n                        _buildCompileFnForVar(itemName, outList);\r\n                        var forTmpl = extend.tmpl;\r\n                        if (forTmpl)\r\n                            outList.push('__includeRender(\"' + _escapeBuildString(forTmpl) + '\", componet, element, ' + _getInsertTemp(preInsert) + ', subject, ' + itemName + ');');\r\n                        else\r\n                            _buildCompileFnContent(tag.children, outList, varNameList, preInsert);\r\n                        outList.push('}, componet, element, ' + _getInsertTemp(preInsert) + ', subject);');\r\n                        preInsert = true;\r\n                        break;\r\n                    case 'if':\r\n                        let ifFn = function (ifTag) {\r\n                            let ifChild = ifTag.children,\r\n                                hasElse = ifChild ? ifChild[ifChild.length - 1].tagName == 'else' : false,\r\n                                elseTag = hasElse ? ifChild.pop() : null;\r\n                            outList.push('__ifRender(function (componet, element, subject) {');\r\n                            outList.push('return ' + (ifTag.content || 'true'));\r\n                            outList.push('}, function (componet, element, subject) {');\r\n                            _buildCompileFnContent(ifChild, outList, varNameList, preInsert);\r\n                            outList.push('}, function (componet, element, subject) {');\r\n                            if (hasElse) {\r\n                                ifFn(elseTag);\r\n                                //_buildCompileFnContent(elseTag.children, outList, varNameList, preInsert);\r\n                            }\r\n                            outList.push('}, componet, element, ' + _getInsertTemp(preInsert) + ', subject);');\r\n                        };\r\n                        ifFn(tag);\r\n\r\n                        preInsert = true;\r\n                        break;\r\n                    case 'include':\r\n                        let incAttr = CmpxLib.arrayToObject<IAttrInfo>(tag.attrs, 'name'),\r\n                            incTmpl = incAttr['tmpl'],\r\n                            incParam = incAttr['param'] ? incAttr['param'].value : 'null',\r\n                            incRender: any = incAttr['render'];\r\n                        incRender && (incRender = 'function(){ return ' + incRender.value + '}');\r\n                        let context = incRender ? incRender : ('\"' + (incTmpl ? _escapeBuildString(incTmpl.value) : '') + '\"');\r\n                        outList.push('__includeRender(' + context + ', componet, element, ' + _getInsertTemp(preInsert) + ', subject, ' + incParam + ');');\r\n                        preInsert = true;\r\n                        break;\r\n                    case 'tmpl':\r\n                        let tmplAttr = CmpxLib.arrayToObject<IAttrInfo>(tag.attrs, 'name'),\r\n                            tmplId = tmplAttr['id'],\r\n                            tmplLet = tmplAttr['let'];\r\n                        outList.push('__tmplRender(\"' + (tmplId ? _escapeBuildString(tmplId.value) : '') + '\", componet, element, subject, function (componet, element, subject, param) {');\r\n                        tmplLet && outList.push('var ' + tmplLet.value + ';');\r\n                        _buildCompileFnContent(tag.children, outList, varNameList, preInsert);\r\n                        outList.push('});');\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    };","import { CompileSubject, CompileRender, VM } from './compile';\r\n\r\nexport class Componet {\r\n    readonly $name: string;\r\n    readonly $parent: Componet;\r\n    readonly $children: Array<Componet> = [];\r\n    readonly $subObject: CompileSubject;\r\n    //readonly $elements: Array<HTMLElement | Text> = [];\r\n    readonly $parentElement: HTMLElement;\r\n\r\n    /**\r\n     * 更新View，View与Componet数据同步\r\n     * @param p 传入参数\r\n     */\r\n    $update(p?: any) {\r\n        if (this.$isDisposed) return;\r\n        this.onUpdateBefore(() => {\r\n            if (this.$isDisposed) return;\r\n            this.$subObject.update({\r\n                componet: this,\r\n                param: p\r\n            });\r\n        }, p);\r\n        this.onUpdate(function(){}, p);\r\n    }\r\n\r\n    private updateId:any;\r\n    /**\r\n     * 步异步更新View，View与Componet数据同步\r\n     * @param p 传入参数\r\n     */\r\n   $updateAsync(callback?:()=>void, p?:any){\r\n       this.updateId && clearTimeout(this.updateId);\r\n        this.updateId = setTimeout(() => {\r\n            this.updateId = null;\r\n            this.$update(p);\r\n            callback && callback.apply(this);\r\n        }, 5);\r\n    }\r\n\r\n    /**\r\n     * 将模板生成CompileRender, 用于include标签动态绑定用\r\n     * 注意动态模板里不要模板变量(viewvar)，请参数p传入，原因编译压缩后模板变量会改变\r\n     * @param tmpl 模板文本\r\n     * @param p 传入模板参数\r\n     */\r\n    $render(tmpl: string, p?:Object): CompileRender {\r\n        var rd = new CompileRender(tmpl, null, p);\r\n        return rd;\r\n    }\r\n\r\n    /**\r\n     * 在解释View之前触发，一般准备数据用\r\n     * @param cb 处理完成后，通知继续处理\r\n     * @param p 传入的参数\r\n     */\r\n    onInit(cb: (err?: any) => void, p?: any): void {\r\n        cb && cb();\r\n    }\r\n\r\n    /**\r\n     * 准备好Viewvar后, 在onInit之后、onReady之前触发\r\n     * @param cb 处理完成后，通知继续处理\r\n     * @param p 传入的参数\r\n     */\r\n    onInitViewvar(cb: (err?: any) => void, p?: any): void {\r\n        cb && cb();\r\n    }\r\n\r\n    /**\r\n     * View所有东西已经处理完成时触发\r\n     * @param cb 处理完成后，通知继续处理\r\n     * @param p 传入参数\r\n     */\r\n    onReady(cb: (err?: any) => void, p?: any): void {\r\n        cb && cb();\r\n    }\r\n\r\n    /**\r\n     * $update前时触发\r\n     * @param cb 处理完成后，通知继续处理\r\n     */\r\n    onUpdateBefore(cb: (err?: any) => void, p?: any): void {\r\n        cb && cb();\r\n    }\r\n\r\n    /**\r\n     * $update后时触发\r\n     * @param cb 处理完成后，通知继续处理\r\n     */\r\n    onUpdate(cb: (err?: any) => void, p?: any): void {\r\n        cb && cb();\r\n    }\r\n\r\n    /**\r\n     * 是否已经释放\r\n     */\r\n    $isDisposed: Boolean = false;\r\n    /**\r\n     * 在componet释放前触发\r\n     */\r\n    onDispose() {\r\n    }\r\n\r\n    constructor() {\r\n    }\r\n}\r\n","import { Componet } from './componet';\r\n\r\nexport default abstract class Platform {\r\n    abstract boot(component: any): Platform;\r\n}","import Platform from './platform';\r\nimport { Componet } from './componet';\r\nimport { Compile, CompileSubject } from './compile';\r\nimport { HtmlDef, HtmlTagDef, ICreateElementAttr, DEFULE_TAG, DEFAULT_ATTR, DEFAULT_ATTR_PROP, DEFAULT_EVENT_DEF, SINGLE_TAG } from './htmlDef';\r\nimport CmpxLib from './cmpxLib';\r\n\r\nlet _getParentElement = function (element: Node): Node {\r\n    return element.parentElement || element.parentNode;\r\n},\r\n    _setAttribute = function (element: HTMLElement, attrs: ICreateElementAttr[]) {\r\n        CmpxLib.each(attrs, function (item: ICreateElementAttr) {\r\n            HtmlDef.getHtmlAttrDef(item.name).setAttribute(element, item.name, item.value, item.subName);\r\n        });\r\n    },\r\n    _htmlTtype = /script|style/i,\r\n    _createElementRaw = function (name: string, attrs: ICreateElementAttr[], parent?: HTMLElement, content?: string): HTMLElement {\r\n        let element: HTMLElement = document.createElement(name);\r\n        element[_htmlTtype.test(name) ? 'innerHTML' : 'innerText'] = content || \"\";\r\n        _setAttribute(element, attrs);\r\n        return element;\r\n    };\r\n\r\nlet _rawTag = new HtmlTagDef({\r\n    //不解释内容，在createElement创建器传入content内容\r\n    raw: true,\r\n    //单行tag\r\n    single: false,\r\n    //创建器\r\n    createElement: _createElementRaw\r\n});\r\n\r\n/**\r\n * htmlDef配置\r\n */\r\nlet _htmlConfig = function () {\r\n\r\n    //扩展tag, 如果不支持请在这里扩展\r\n    HtmlDef.extendHtmlTagDef({\r\n        //默认不支持svg, 请处理HtmlTagDef的createElement参数\r\n        'svg': DEFULE_TAG,\r\n        //默认不支持math, 请处理HtmlTagDef的createElement参数\r\n        'math': DEFULE_TAG,\r\n        'br': SINGLE_TAG,\r\n        'style': _rawTag,\r\n        'script': _rawTag,\r\n        'title': _rawTag,\r\n        'textarea': _rawTag\r\n    });\r\n\r\n    //扩展attr, 如果不支持请在这里扩展\r\n    HtmlDef.extendHtmlAttrDef({\r\n        'name': DEFAULT_ATTR,\r\n        'value': DEFAULT_ATTR_PROP,\r\n        'type': DEFAULT_ATTR_PROP\r\n    });\r\n\r\n    //扩展事件处理, 如果不支持请在这里扩展\r\n    HtmlDef.extendHtmlEventDef({\r\n        \"click\": DEFAULT_EVENT_DEF\r\n    });\r\n\r\n    // //更改默认值，参考如下：\r\n    // DEFAULT_EVENT_DEF.addEventListener = (element: HTMLElement, eventName: string, context: (event: any) => any, useCapture: boolean) {\r\n    //     element.addEventListener(eventName, context, useCapture);\r\n    //     //attachEvent\r\n    // }\r\n\r\n    Compile.loadTmplCfg(function (url: string, cb: (tmpl: string | Function) => void) {\r\n        let xhr: XMLHttpRequest = new XMLHttpRequest(),\r\n            headers = {\r\n                'X-Requested-With': 'XMLHttpRequest',\r\n                'Accept': 'text/plain, */*; q=0.01',\r\n                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'\r\n            },\r\n            protocol = /^([\\w-]+:)\\/\\//.test(url) ? RegExp.$1 : window.location.protocol;\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4) {\r\n                if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304 || (xhr.status == 0 && protocol == 'file:')) {\r\n                    cb(xhr.responseText);\r\n                } else {\r\n                    cb('');\r\n                }\r\n            }\r\n        };\r\n\r\n        xhr.open('GET', url, true);\r\n        xhr.send(null);\r\n    });\r\n};\r\n\r\nexport class Browser extends Platform {\r\n\r\n    constructor() {\r\n        super();\r\n        //htmlDef配置\r\n        _htmlConfig();\r\n        //编译器启动，用于htmlDef配置后\r\n        Compile.startUp();\r\n    }\r\n\r\n    boot(componetDef: any): Browser {\r\n\r\n        let name = componetDef.prototype.$name,\r\n            bootElement: HTMLElement = document.getElementsByTagName(name)[0];\r\n        if (!bootElement)\r\n            throw new Error(`没有${name}标签`);\r\n\r\n        let _doc = document, parentElement = _getParentElement(bootElement);\r\n        let preElement: any = bootElement.previousSibling;\r\n        if (!preElement) {\r\n            preElement = _doc.createComment(name);\r\n            parentElement.insertBefore(preElement, bootElement);\r\n        }\r\n        parentElement.removeChild(bootElement);\r\n        bootElement = preElement;\r\n\r\n        ////DOMContentLoaded 时起动\r\n        let _readyName = 'DOMContentLoaded', _ready = function () {\r\n            _doc.removeEventListener(_readyName, _ready, false);\r\n            window.removeEventListener('load', _ready, false);\r\n\r\n            //注意tmplElement是Comment, 在IE里只能取到parentNode\r\n            let parentElement = _getParentElement(bootElement);\r\n            Compile.renderComponet(componetDef, bootElement, function (newSubject: CompileSubject, refComponet: Componet) {\r\n                parentElement.removeChild(bootElement);\r\n                //console.log(refComponet);\r\n\r\n                let _unload = function () {\r\n                    window.removeEventListener('unload', _unload);\r\n                    newSubject.remove({\r\n                        componet: refComponet\r\n                    });\r\n                };\r\n                window.addEventListener('unload', _unload, false);\r\n            });\r\n        };\r\n\r\n        if (/loaded|complete|undefined/i.test(_doc.readyState))\r\n            _ready();\r\n        else {\r\n            _doc.addEventListener(_readyName, _ready, false);\r\n            window.addEventListener(\"load\", _ready, false);\r\n\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n}"],"names":["_getParentElement","tslib_1.__extends"],"mappings":"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"}